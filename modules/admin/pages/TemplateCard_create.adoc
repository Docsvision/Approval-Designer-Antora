[[ariaid-title1]]
== Создание шаблона согласования

Создание карточек шаблонов согласований могут производить любые пользователи модуля.

С одним шаблоном согласования могут быть связаны несколько маршрутов согласования, для которых определены различные условия запуска. При отправке карточки [.dfn .term]_Документ_ (и ее дочерних видов) на согласование, в зависимости от заданных условий, выполняется подбор подходящего маршрута. Условие запуска формируется как поисковый запрос, атрибутом которого является некоторое поле карточки [.dfn .term]_Документ_.

Чтобы создать шаблон согласования, выполните следующие действия:

. [.ph .cmd]#Выполните любое из действий:#
* В представлении Windows-клиента вызовите контекстное меню, затем выберите команду [.ph .menucascade]#[.ph .uicontrol]*Создать карточку* > [.ph .uicontrol]*Согласование* > [.ph .uicontrol]*Согласование КС*#;
* Нажмите на кнопку [.keyword]*Создать карточку* на ленте Windows-клиента, затем выберите из контекстного меню кнопки вид карточки [.ph .menucascade]#[.ph .uicontrol]*Согласование* > [.ph .uicontrol]*Согласование КС*#.
+
В любом случае будет открыта новая карточка [.keyword .parmname]_Шаблон согласования_.

[NOTE]
====
[.note__title]#Важное замечание:# Карточка шаблона согласования должна быть карточкой вида [.dfn .term]_Согласование / Согласование КС_ или подвидов [.dfn .term]_Согласование КС_. Использование карточек других видов (включая другие подвиды [.dfn .term]_Согласование_) приведёт к ошибке согласования.
====
. [.ph .cmd]#В поле [.keyword]*Название* введите название шаблона. #
. [.ph .cmd]#Чтобы при создании согласования у [.keyword]*Инициатора* открывалась карточка [.keyword .parmname]_Согласование КС_, в которой можно ознакомиться с маршрутом, снимите флаг [.ph .uicontrol]*Запускать согласование без показа карточки*. По умолчанию параметр не установлен. #
+
При отсутствии флага запуск согласования необходимо будет выполнять вручную, при помощи одноименной командой ленты. При наличии флага согласование будет запущено автоматически.

Данная настройка не оказывает влияния на проверку условий запуска маршрутов (если они определены).
. [.ph .cmd]#Чтобы можно было запустить процесс согласования карточки документа без вложенных основных файлов, установите флаг [.ph .uicontrol]*Разрешить запуск согласования без файлов*. #
+
В этом случае согласование будет выполняться для отправленной в задании карточки документа. [.dfn .term]_Основные_ и [.dfn .term]_дополнительные_ файлы могут быть добавлены в задание позже, в процессе активного согласования.

Если согласование без файлов запрещено, при запуске подготовленного согласования [.keyword]*инициатору* будет выдаваться предупреждение о необходимости добавления [.dfn .term]_основных_ файлов.
. [.ph .cmd]#В поле [.keyword]*Маршрут согласования по умолчанию* выберите карточку xref:Approval_path.adoc[Маршрут согласования], которая будет использоваться при запуске согласования по умолчанию. Поле является обязательным для заполнения.#
+
Чтобы состав маршрута, используемого по умолчанию, отобразился в таблице [.keyword]*Состав маршрута*, установите фокус на данное поле.

[NOTE]
====
[.note__title]#Прим.:# Один и тот же маршрут может быть использован для согласования разных видов документов.
====
+
В области [.keyword]*Состав маршрута* будет отображен список этапов, входящих в маршрут. Маршруты будут отображены в том же порядке, что и в xref:Path_roadmap.adoc[карте этапов].

Чтобы открыть этап для редактирования, дважды щелкните левой клавишей мыши по записи.

image::img/Template.png[[.fig--title-label]##Рис. 1. ##Карточка 'Шаблон согласования']
. [.ph .cmd]#Если шаблон предполагается использовать для запуска нескольких маршрутов, в таблице [.keyword]*Маршруты согласования по условию* сформируйте список маршрутов и определите для каждого из них условия старта. #
+
Чтобы добавить маршрут в таблицу, нажмите кнопку image:img/Buttons/add_green_plus.png[image] и выберите карточку нужного маршрута. Название добавленного маршрута будет отображено в поле [.keyword]*Маршрут*. Этапы добавленного маршрута будут отображены в таблице [.keyword]*Состав маршрута*. Открыть карточку добавленного маршрута можно нажатием кнопки image:img/Buttons/view.png[image].

В поле [.keyword]*Приоритет* будет автоматически сформирован приоритет запуска маршрута, соответствующий порядковому номеру маршрута при добавлении. При необходимости приоритет может быть изменен путем перемещения строки маршрута по таблице кнопками image:img/Buttons/arrow_up_green.png[image] и image:img/Buttons/arrow_down_green.png[image].

Чтобы задать условие запуска маршрута, в поле [.keyword]*Условие* щелкните кнопку image:img/Buttons/threedots.png[image] в правой части поля. В открывшемся окне [.keyword]*Фильтр карточек* задайте условие для поискового запроса по атрибутам документа. В данном окне можно как создать новый запрос, так и загрузить существующий. Использование поисковых запросов с параметрами запрещено. После сохранения условий поискового запроса, в поле таблицы появится значение `Задано`. Если условие не задано, поле таблицы будет пустым. При запуске согласования подбор маршрута будет выполняться по следующим правилам:

[loweralpha]
.. Если поле [.keyword]*Условие* не заполнено, маршрут будет использован в согласовании.
.. Если поле [.keyword]*Условие* заполнено, будет выполнен поисковый запрос. Если карточка документа удовлетворит условиям запроса, маршрут будет использован в согласовании. Условия проверяются в порядке приоритета. После нахождения первого условия, которому удовлетворит карточка документа, маршрут будет использован, а остальные условия проверяться не будут.
.. Если ни одно из условий не выполняется, в согласовании будет использован маршрут по умолчанию.

В поле [.keyword]*Описание условия* введите с клавиатуры произвольное описание созданных ранее условий запуска маршрута.

Чтобы удалить маршрут из таблицы, нажмите image:img/Buttons/delete_red_x.png[image].
. [.ph .cmd]#Сохраните карточку.#
. [.ph .cmd]#Перейдите в [.dfn .term]_Справочник видов карточек_ и настройте режим создания карточки.#

*На уровень выше:* xref:../pages/Engineer_functions.adoc[Настройка согласований]
