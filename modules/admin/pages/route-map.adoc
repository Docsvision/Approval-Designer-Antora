= Сформировать карту этапов

_Карта этапов_ определяет этапы, входящие в состав маршрута, а также условия перехода между ними (в зависимости от результатов завершения предыдущих этапов).

При настройке маршрута согласования нужно учитывать принцип, по которому выбираются этапы согласования:

При завершении каждого этапа согласования начинается поиск следующего не запускавшегося в данном цикле этапа, соответствующего условиям запуска.

.Если подходящий этап не найден:
* Если все этапы данного цикла завершены положительно, согласование завершается.
* Если есть не положительно завершенные этапы, запускается новый цикл согласования.
+
Автоматический переход на новый цикл согласования можно исключить, добавив этап консолидации (можно без участников) после этапов, которые могут завершиться условно-положительно.

.Чтобы настроить карту этапов:
. Создайте или откройте ранее созданную карточку _Маршрут согласования_.
. В области _Карта этапов_ нажмите на кнопку image:buttons/plus-green.png[Плюс] *Добавить*, чтобы отобразить строку для настройки этапа.
+
.Поля для настройки этапа в "Карте этапов"
image::add-stage.png[Поля для настройки этапа в "Карте этапов"]
+
. Нажмите image:buttons/three-dots.png[Три точки] и выберите карточку этапа из созданных ранее.
+
Одна и та же карточка _Этап согласования_ может быть использована в разных маршрутах.
+
Один этап можно добавить в один маршрут только один раз. Повторно добавлять тот же этап в маршрут запрещено.
+
include::partial$excerpts.adoc[tags=stage]
+
Допускается добавлять новые этапы даже в те маршруты, по которым на момент добавления выполняется активное согласование документов. При удовлетворении условий запуска, новый этап может быть пройден уже в текущем цикле согласования. Аналогично, при удалении этапа из активного маршрута, изменения будут применены в текущем цикле согласования.
+
. Повторяйте шаги 2-3 до тех пор, пока не будут добавлены все необходимые этапы.
. xref:route-stage-conditions.adoc[Задайте] условия старта для всех этапов, кроме первого.
+
[CAUTION]
====
Условия старта нужно задавать после добавления в маршрут всех этапов.
====
+
В _Карте этапов_ столбцы _Тип согласования_, _Согласующие_ и _Длительность_ будут автоматически заполнены исходя из данных карточки _Этап согласования_.
+
. Чтобы этапы отображались в карте в соответствии с заданными условиями старта, воспользуйтесь кнопками image:buttons/arrow-up-green.png[Стрелка вверх] и image:buttons/arrow-down-green.png[Стрелка вниз] для перемещения записей этапов вверх или вниз по списку.
+
Отображение этапов в таблице никак не влияет на фактический порядок старта этапов, который определяется заданными для этапа условиями.
