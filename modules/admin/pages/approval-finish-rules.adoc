= Правила завершения согласований

В рамках каждого этапа процесса согласования формируется некоторое количество заданий. Каждое задание может быть завершено одним из возможных способов, определенных семантикой решения. Результат завершения этапа будет вычисляться исходя из решений, вынесенных согласующими в заданиях на согласование.

.Пример процесса согласования
image::route-finish-process.png[Пример процесса согласования]

В данной версии модуля _Конструктора согласований_ предусмотрены следующие xref:task-decisions.adoc[варианты решений], которые могут быть приняты согласующими:

:approvers:
include::partial$excerpts.adoc[tags=decisions]

== Правила завершения этапов

* Этап завершается _Положительно_, если все входящие в него задания завершились с семантикой _Положительное_.
* Этап завершается _Условно-положительно_, если задания завершились с семантикой _Положительное_ и _Условно-положительное_.
* Этап завершается _Отрицательно_, если хотя бы одно задание завершено с семантикой _Отрицательное_.
* Как только задание на этапе завершается с результатом _Новый цикл_, все задания, не завершенные на этом этапе (если такие ещё есть) отзываются, стартует _Новый цикл_ согласования.
* Если задание на каком-либо этапе завершается с семантикой _Отмена_, задания КС отзываются, согласование аннулируется, а согласуемый документ возвращается в состояние `Подготовка`.
* Если задание завершается с семантикой _Завершение_, завершается целиком весь процесс согласования, документ переводится в финальное состояние, определенное в настройках карточки _Маршрут согласования_.

.Этап может быть завершен принудительно:
* Инициатором из карточки открытого согласования, командой _Прекратить текущий этап_, см. xref:user:approval-force-finish-stage.adoc[].
* Одним из согласующих, если настройка xref:stage-finish-settings.adoc["При первом отказе"] установлена в значение _Завершить этап_.
+
[NOTE]
====
В некоторых случаях, для завершения этапа может использоваться семантика, xref:stage-finish-settings.adoc[заданная по умолчанию] и другие настройки. Например, семантика будет применена, если в настройках этапа не были заданы согласующие.
====

== Правила завершения маршрута согласования

* Маршрут завершается _Автоматически_, если положительно завершились все его этапы.
* При завершении маршрута согласование перейдёт на новый цикл, если один из этапов завершился условно-положительно и после данного этапа не было консолидации.

.Маршрут может быть завершен _Принудительно_:
* _Инициатором_ из карточки Согласования.
* Пользователем из карточки задания на согласование при выборе варианта решения с xref:task-decisions.adoc[семантикой] _Завершение_.
* Одним из согласующих, если настройка xref:stage-finish-settings.adoc["При первом отказе"] установлена в значение _Завершить согласование_.
