= Правила завершения согласований

В рамках каждого этапа процесса согласования формируется некоторое количество заданий, каждое из которых может быть завершено одним из возможных способов, определенных семантикой решения. Результат завершения этапа будет вычисляться исходя из решений, вынесенных согласующими в заданиях на согласование.

.Пример процесса согласования
image::Path_finish_success.png[Пример процесса согласования]

В данной версии модуля _Конструктора согласований_ предусмотрены следующие xref:StageParams_task_decisions.adoc[варианты решений], которые могут быть приняты согласующими:

* *Положительное* (например, "Согласовать", "Подписать");
* *Условно-положительное* (например, "Согласовать с замечаниями");
* *Отрицательное* (например, "Не утвердить", "Отказать");
* *Новый цикл* – запуск нового цикла согласования (повторный старт маршрута);
* *Отмена* – отмена текущего согласования с отзывом всех заданий (например, "Вернуть на подготовку");
* *Завершение* – окончание процесса согласования, документ прошел все этапы процесса – согласован, подписан, зарегистрирован и т.д. (Например, "Зарегистрировать").

.Правила завершения этапов:
* Этап завершается ПОЛОЖИТЕЛЬНО, если все входящие в него задания завершились с семантикой *Положительное*;
* Этап завершается УСЛОВНО-ПОЛОЖИТЕЛЬНО, если задания завершились с семантикой *Положительное* и *Условно-положительное*;
* Этап завершается ОТРИЦАТЕЛЬНО, если хотя бы одно задание завершено с семантикой *Отрицательное*;
* Как только задание на этапе завершается с результатом *Новый цикл*, все задания, не завершенные на этом этапе (если такие ещё есть) отзываются, стартует НОВЫЙ ЦИКЛ согласования;
* Если задание на каком-либо этапе завершается с семантикой *Отмена*, задания КС отзываются, согласование аннулируется, а согласуемый документ возвращается в состояние `Подготовка`;
* Если задание завершается с семантикой *Завершение*, это означает, что завершается целиком весь процесс согласования, документ переводится с финальное состояние (определенное в настройках карточки *Маршрут согласования*).

.Этап может быть завершен ПРИНУДИТЕЛЬНО:
* инициатором из карточки открытого согласования, командой *Прекратить текущий этап* (см. _Модуль "Docsvision 5. Конструктор согласований". Руководство пользователя_);
* при первом отказе одним из согласующих, при значении настройки xref:StageParamsExtra_stage_finish.adoc[*При первом отказе*] равном _Завершить этап_.
+
[NOTE]
====
В некоторых случаях, для завершения этапа может использоваться семантика, xref:StageParamsExtra_stage_finish.adoc[заданная по умолчанию] и другие настройки. Например, семантика будет применена, если в настройках этапа не были заданы согласующие.
====

.Правила завершения маршрута согласования:
* Маршрут завершается АВТОМАТИЧЕСКИ, если положительно завершились все его этапы;
* При завершении маршрута согласование перейдёт на новый цикл, если один из этапов завершился условно-положительно и после данного этапа не было консолидации.
* Маршрут может быть завершен ПРИНУДИТЕЛЬНО:
** *Инициатором* из карточки Согласования;
** пользователем из карточки задания на согласование при выборе варианта решения с xref:StageParams_task_decisions.adoc[семантикой] *Завершение*;
** при первом отказе одним из согласующих, при значении настройки xref:StageParamsExtra_stage_finish.adoc[*При первом отказе*] равном _Завершить согласование_.
