= Работа с консолидируемыми файлами

Консолидатор работает с согласуемыми файлами в области _Файлы для консолидации_ карточки _Задание -- на консолидацию_.

Версии консолидируемых файлов отображаются аналогично xref:consolidation-version-tree.adoc[версиям согласующего].

.Консолидатору доступны операции:
* xref:approval-version-tree.adoc#view-version[Просмотр версии файла].
* xref:approval-version-tree.adoc#open-version[Открытие версии файла].
* xref:approval-version-tree.adoc#load-version[Загрузка версии из файла].
* xref:approval-version-tree.adoc#create-version[Создание версии файла на основе выбранной]. Команда создает новую версию, подчинённую начальной версии согласующего.
* xref:approval-version-tree.adoc#delete-version[Удаление версии файла].
* <<comments,Добавление комментария к версии>>.
* _Объединить версии_. Команда доступна для исходной версии этапа консолидации. Команда объединяет подчинённые выбранной версии, если они ещё не были консолидированы. В результате выполнения команды будет создана итоговая версия этапа консолидации.
* _Взять в качестве консолидируемой_. Команда назначает версию исходной версией этапа.
+
NOTE: Команда недоступна для усовершенствованного согласования.
+
* Команда _Сделать версию итоговой_ помечает любую выбранную версию итоговой.
* Команда _Сравнить с итоговой_ (ранее: _Сравнить с консолидируемой_). Команда сравнивает выбранную версию с итоговой версией.

[#version]
== Создание консолидированной версии

_Консолидатор_ работает с согласуемыми файлами так же, как участник согласования: может создавать свои версии, просматривать версии других согласующих, комментировать их, и при этом имеет ряд дополнительных возможностей.

.Чтобы создать итоговую версию согласуемого документа:
. Откройте полученную карточку задания на консолидацию.
+
В области _Файлы для консолидации_ будут отображаться стартовые версии этапов согласования и версии, добавленные согласующими.
+
Также у _Консолидатора_ будет отображаться _Итоговая версия этапа_. В полученном задании данная версия будет совпадать со стартовой версией этапа, если предшествующий текущему этап был параллельный, или с последней созданной на предыдущем этапе версией, если этап был последовательным или альтернативным.
+
//TODO: Скрины
.Пример отображения версий файлов у "Консолидатора"
image::consolidator-files.png[Пример отображения версий файлов у "Консолидатора"]
+
. Если на каком-либо этапе в согласовании принимали участие несколько согласующих, и было создано несколько разных версий файла, вы можете автоматически объединить версии в одну (функция предусмотрена только для файлов Microsoft Word). Для этого выделите требуемый этап, правой кнопкой мыши вызовите контекстное меню, затем выберите команду _Объединить версии_.
+
При этом будет сформирована _Объединенная версия этапа_, в которую будут скопированы все изменения документа, добавленные согласующими.
+
. Выделите в дереве версию, на основе которой будет создаваться итоговая версия. Правой кнопкой мыши вызовите контекстное меню, затем выберите команду _Взять в качестве консолидируемой_.
+
Версия, взятая за основу, в терминах системы называется xref:consolidation-files.adoc["Консолидируемая версия"]. Взять в качестве консолидируемой можно любую версию файла.
+
При этом будет создана xref:consolidation-files.adoc["Консолидированная версия"] файла. Название версии будет выделено курсивом.
+
.Формирование консолидированной версии
image::consolidated-version.png[Формирование консолидированной версии]
+
. Последовательно сравните каждую из версий документа с итоговой. Выберите версию для сравнения, затем вызовите контекстное меню и выберите пункт _Сравнить с итоговой_.
+
.Сравнение версии согласующих с итоговой версией
image::compare-with-consolidated.png[Сравнение версии согласующих с итоговой версией]
+
Сравнение будет выполнено средствами Microsoft Word. Функция доступна только для расширений, поддерживаемых данным приложением. При сравнении будет создана новая версия, содержащая изменения из обоих документов.
+
. Для документа формата Microsoft Word выполните сравнение версий: внесите необходимые изменения в консолидируемую версию.
+
Для файлов других форматов данная операция будет недоступна. По завершении сравнения сохраните файл и закройте окно редактора.
+
Вы будете возвращены в карточку задания на консолидацию.
+
. Чтобы сформировать итоговую версию, выберите в дереве консолидируемую версию, затем выберите пункт _Сделать версию итоговой_. Данный шаг является обязательным при выполнении консолидации.
+
.Создание итоговой версии документа
image::make-final.png[Создание итоговой версии документа]
+
Версия, к которой применена команда, будет скопирована в xref:consolidation-version-tree.adoc["Итоговую версию этапа"]. Данная версия в последующих этапах прохождения маршрута будет использоваться в качестве исходной.

[#comments]
== Работа с комментариями при консолидации

При выполнении консолидации предусмотрены два вида комментариев, которые могут быть добавлены _Консолидатором_:

xref:approval-version-tree.adoc#comment-version[Комментарий к версии]::
Комментарий добавляется при помощи контекстного меню, вызываемого в области _Файлы для согласования_.
+
Комментарий будет отображаться у _Инициатора_ согласования при открытии активного согласования и у _Консолидатора_ в области _Комментарии_ карточки задания.

xref:approval-decide.adoc[Комментарий к решению]::
Комментарий добавляется при принятии условно-положительного или отрицательного решения по консолидации.
+
Просмотр комментария будет доступен остальным участниками согласования в области _Комментарии_ заданий на согласование.
+
Кроме того, _консолидатору_ доступен просмотр комментариев к версиям, добавленных другими участниками согласования.

== Завершение задания на консолидацию

Чтобы завершить здание на консолидацию по логике усовершенствованного согласования, необходимо обязательно выбрать итоговую версию.

include::partial$excerpts.adoc[tags=on-finish]