= Особенности работы с версиями и комментариями к версиям

Для полнофункциональной работы с версиями в карточке заданий на согласование предназначена вкладка *Версии и комментарии*. Согласуемые файлы отображаются на отдельных вкладках.

[NOTE]
====
Новые файлы, добавленные в согласование после его запуска, будут отображаться у согласующих после старта следующего этапа согласования. См. xref:Approving_add_new_files_to_approval_from_doc.adoc[Добавление новых файлов в согласование в процессе согласования].
====

.Элемент для работы с версиями файлов в режиме "Согласование"
image::files_version_tree.png[Элемент для работы с версиями файлов в режиме "Согласование"]

.Версии согласуемых файлов отображаются в задании следующим образом:
* _Корневая версия_ – отображается версия, которая является текущей в карточке _Документ_;
* _Версия цикла_ – версия документа, которая поступила на согласование при старте данного цикла. Если цикл первый, версия будет совпадать с корневой. В последующих циклах будет отображаться итоговая версия последнего из этапов цикла. Формирование данной версии выполняется модулем _Docsvision 5. Управление процессами_;
* _Исходная версия этапа_ – версия, поступающая к согласующему при старте очередного этапа. Формирование данной версии выполняется модулем _Docsvision 5. Управление процессами_;
* _Версия согласующего_ – версия отдельного участника согласования, созданная им вручную. Может быть создана как на основе версии другого согласующего, так и на основе _Исходной версии этапа_;
+
[NOTE]
====
Версия не создается на этапе подписания.
====
+
Если для этапа настроен тип маршрутизации _параллельный_, все согласующие получат для согласования _исходную версию этапа_ – для первого этапа в цикле совпадает с версией цикла. Если в процессе согласования будут добавлены _версии согласующих_, они будут независимо сохранены. Объединение версий согласующих в рамках этапа может быть выполнено только на этапе консолидации. На следующий этап будет передана:
+
* версия консолидатора – если консолидация выполнялась;
* версия согласующего – если в этапе была создана только одна версия;
* или исходная версия этапа – если в этапе было создано несколько версий.
+
Если для этапа настроен тип маршрутизации _последовательный_ или _альтернативный_, и в процессе согласования будут добавлены _версии согласующих_, каждый следующий согласующий будет получать для согласования не _исходную версию этапа_, а версию предыдущего согласующего. Таким образом, в версии последнего согласующего этапа будут накоплены все изменения, которые будут выполнены на этапе, и эта версия поступит в качестве _Исходной версии_ на следующий этап. Такой способ формирования версий этапов имеет ряд особенностей:
+
* предыдущий этап должен был быть выполнен отдельно, а не одновременно с другим этапом;
* если ни одной версии на этапе создано не было, на следующий этап будет передана та же версия, что и на предыдущий этап;
* если предшествующий текущему этап был с типом маршрутизации _параллельный_ или же стартовал одновременно с другим этапом, на вход текущему этапу будет передана та же версия, что и на предыдущие этапы;
* если предшествующий текущему этап был запущен в режиме _консолидация_, на вход текущему этапу будет передана _Итоговая версия этапа_, сформированная на этапе консолидации.
+
Пользователь может выполнить следующие действия:
+
* xref:File_view_version.adoc[просмотреть версию файла];
* xref:File_open_version.adoc[открыть версию файла];
* xref:File_load_from_file.adoc[загрузить версию из файла];
* xref:File_create_version.adoc[создать версию файла на основе текущей];
* xref:Comments.adoc[добавить комментарий к версии].
